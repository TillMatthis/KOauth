# KOauth Environment Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# Server Configuration
# =============================================================================

# Environment: development | production | test
NODE_ENV=development

# Server port and host
# PORT: The port on which the application will be exposed on the host machine
#       In Docker, this maps to the host port while the app listens on 3000 internally
PORT=3000
HOST=0.0.0.0

# Logging level: error | warn | info | debug | trace
LOG_LEVEL=debug

# =============================================================================
# Database Configuration
# =============================================================================

# PostgreSQL (Production)
# DATABASE_URL=postgresql://koauth:password@localhost:5432/koauth?schema=public

# SQLite (Development - uncomment to use)
DATABASE_URL=file:./dev.db

# =============================================================================
# Security & Authentication
# =============================================================================

# Session secret (use a strong random string in production)
# Generate with: openssl rand -base64 32
SESSION_SECRET=your-session-secret-here-change-in-production

# JWT secret for access tokens (DEPRECATED - now using RS256 with RSA keys)
# This is kept for backward compatibility but is no longer required
JWT_SECRET=your-jwt-secret-here-change-in-production

# JWT expiration times
JWT_EXPIRES_IN=15m
REFRESH_TOKEN_EXPIRES_IN=7d

# JWT Issuer and Audience (for RS256 tokens)
# These should match your production domain
JWT_ISSUER=https://auth.tillmaessen.de
JWT_AUDIENCE=https://auth.tillmaessen.de

# RSA Keys for JWT RS256 signing (optional - will auto-generate if not provided)
# If you want to provide your own keys, generate them with:
#   openssl genrsa -out jwt-private.pem 2048
#   openssl rsa -in jwt-private.pem -pubout -out jwt-public.pem
#   cat jwt-private.pem | base64 -w 0
#   cat jwt-public.pem | base64 -w 0
# Then set the base64-encoded keys here:
JWT_PRIVATE_KEY=
JWT_PUBLIC_KEY=
JWT_KEY_ID=

# Cookie settings
COOKIE_DOMAIN=localhost
COOKIE_SECURE=false
COOKIE_SAME_SITE=lax

# =============================================================================
# CORS Configuration
# =============================================================================

# Allowed origins (comma-separated for multiple origins)
# Examples:
#   - Single origin: http://localhost:3001
#   - Multiple: http://localhost:3001,http://localhost:3002
#   - All (dev only): *
CORS_ORIGIN=*

# =============================================================================
# OAuth Providers (Task 1.4)
# =============================================================================

# Google OAuth
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=http://localhost:3000/auth/google/callback

# GitHub OAuth
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_REDIRECT_URI=http://localhost:3000/auth/github/callback

# Apple OAuth (Phase 2)
APPLE_CLIENT_ID=
APPLE_TEAM_ID=
APPLE_KEY_ID=
APPLE_PRIVATE_KEY=

# =============================================================================
# Email Configuration (Task 1.2 & 2.2)
# =============================================================================

# Email provider: resend | smtp
EMAIL_PROVIDER=resend

# Sender email address
EMAIL_FROM=noreply@koauth.local

# Resend.com API key
RESEND_API_KEY=

# SMTP configuration (alternative to Resend)
SMTP_HOST=
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=
SMTP_PASSWORD=

# Email verification settings
EMAIL_VERIFICATION_REQUIRED=true
EMAIL_VERIFICATION_TOKEN_EXPIRY=24h

# Password reset settings
PASSWORD_RESET_TOKEN_EXPIRY=1h

# =============================================================================
# Rate Limiting
# =============================================================================

# Global rate limit (requests per time window)
RATE_LIMIT_MAX=100
RATE_LIMIT_TIME_WINDOW=1m

# Auth endpoints rate limit (stricter)
AUTH_RATE_LIMIT_MAX=5
AUTH_RATE_LIMIT_TIME_WINDOW=15m

# =============================================================================
# API Keys (Task 1.3)
# =============================================================================

# Maximum API keys per user
MAX_API_KEYS_PER_USER=10

# Default API key expiration (in days, 0 = no expiration)
API_KEY_DEFAULT_EXPIRY_DAYS=365

# =============================================================================
# Feature Flags
# =============================================================================

# Enable/disable features
ENABLE_SOCIAL_LOGIN=false
ENABLE_EMAIL_VERIFICATION=true
ENABLE_PASSWORD_RESET=true
ENABLE_API_KEYS=false
ENABLE_MFA=false

# =============================================================================
# Application URLs
# =============================================================================

# Base URL for the application (used in emails, redirects, etc.)
BASE_URL=http://localhost:3000

# Frontend URL (if separate from API)
FRONTEND_URL=http://localhost:3001

# =============================================================================
# Admin Configuration (Phase 2)
# =============================================================================

# Admin user emails (comma-separated)
ADMIN_EMAILS=

# Admin dashboard enabled
ADMIN_DASHBOARD_ENABLED=false

# =============================================================================
# Multi-tenancy (Phase 2)
# =============================================================================

# Enable multi-tenant mode
MULTI_TENANT_ENABLED=false

# Default organization name
DEFAULT_ORG_NAME=Default Organization

# =============================================================================
# Monitoring & Observability (Phase 2)
# =============================================================================

# Sentry DSN (error tracking)
SENTRY_DSN=

# Application Insights (Azure)
APPLICATIONINSIGHTS_CONNECTION_STRING=

# =============================================================================
# Development & Testing
# =============================================================================

# Skip email sending in development
SKIP_EMAIL_IN_DEV=true

# Test user credentials (development only)
TEST_USER_EMAIL=test@koauth.local
TEST_USER_PASSWORD=Test123!@#

# =============================================================================
# Docker Configuration
# =============================================================================

# PostgreSQL credentials for docker-compose
POSTGRES_USER=koauth
POSTGRES_PASSWORD=koauth_dev_password
POSTGRES_DB=koauth
